<style>body{margin:0;text-align:center;background:#000;touch-action:none}</style><canvas id="c"></canvas><script>(()=>{const e=window,t=document,o=[38,38,40,40,37,39,37,39,66,65];let a=0;const n=0,s=1,r=2;let i,l,h,m=n;const v=c.getContext("2d"),y=640,g=480,d=c.cloneNode(),w=d.getContext("2d"),A=c.cloneNode(),b=A.getContext("2d"),u="abcdefghijklmnopqrstuvwxyz0123456789.:!-%,/",f=0,M=1,x=2,X={player:{w:10,h:10},sub1:{w:10,h:10}},Y=8;let k,p,P,S,I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVgAAAAIAgMAAADB+w+QAAAADFBMVEUAAAARCgP///8AAADe3w1AAAAAAXRSTlMAQObYZgAAAUlJREFUKM9VUjFuwzAMpAf5BVGB+jVeuquA6CFzUYDqZzzEQ3Z5ENr+sXeiE6MiJNFH8kTSFFXNMWtSrJhz1K7oTDgkTX2rL2L0CCkgApKp9+8kWDwvEUqU0rpUv836bWUuZjbVUvum5Vj0mIhCrEJf/Zu04yryYVBMEOBE23/afrZTHpS+mcbSbEfUrduayDCPa8zvbZiHJt1l6xSbaWkvtwgS0p4Zeij3tMOjFsQsrUC/wkvb9bcYcx3XqY4Vd2UTntlaI62xJWr3BxWwtvRaPu9ThdxAt1/3xatoQ7WvghwpsJJ8FQ/0bIuXeTxk3vOdBY/sIG5qHkFZdvoB+V6AU2Iub8NaZjlcGOIB1HH6L7M0EavIgLTQzweAMnfaflg6RcRex9lEcnwOWPIBi0lxHgMmAQDHLGjodh8o2oFm4Id4E8B3CZLlD7GmBBrI7F8nAAAAAElFTkSuQmCC",D=!0;function T(){a=0,i=60,l=B("player",y/2,g/2,30),h=[l,B("sub1",100,100),B("sub1",100,g-100),B("sub1",y-100,100),B("sub1",y-100,g-100)],m=s}function E(e){0>e.x?e.x=0:e.x>y-e.w&&(e.x=y-e.w),0>e.y?e.y=0:e.y>g-e.h&&(e.y=g-e.h)}function B(e,t=0,o=0,a=20){const{w:n,h:s}=X[e];return{h:s,lastX:t,lastY:o,moveX:0,moveY:0,online:!0,speed:a,type:e,w:n,x:t,y:o}}function F(e){const t=e.speed*p;e.x+=t*e.moveX,e.y+=t*e.moveY,e.angle=0>e.moveX&&0>e.moveY?-45:0>e.moveX&&0===e.moveY?-90:0>e.moveX&&e.moveY>0?-135:0===e.moveX&&0>e.moveY?0:e.moveX>0&&0>e.moveY?45:e.moveX>0&&0===e.moveY?90:e.moveX>0&&e.moveY>0?135:0===e.moveX&&e.moveY>0?180:0}function U(e){"player"===e.type?(e=>{const{x:t,y:o,angle:a}=e;w.save(),w.shadowBlur=10,w.translate(Math.round(t),Math.round(o)),w.fillStyle="rgb(75,190,250)",w.shadowColor=w.fillStyle,w.rotate(a/180*Math.PI),w.beginPath(),w.arc(0,0,5,0,Math.PI+Math.PI),w.fillRect(-2,-12,4,12),w.fill(),w.closePath(),w.restore()})(e):(e=>{const{visibleX:t,visibleY:o,visibleAngle:a}=e;w.save(),w.beginPath(),w.shadowBlur=10,w.fillStyle=l.online?"rgb(230,90,100)":"rgb(55,40,35)",w.shadowColor=w.fillStyle,w.translate(Math.round(t),Math.round(o)),w.rotate(a/180*Math.PI),w.fillRect(-5,-5,10,10),w.fillRect(-2,-12,4,12),w.fill(),w.closePath(),w.restore()})(e)}function C(e){"player"===e.type?(e=>{const{x:t,y:o,angle:a,dashOffset:n=0,dashTime:s=0}=e;w.save(),w.shadowBlur=10,w.translate(Math.round(t),Math.round(o)),w.strokeStyle="rgb(70,105,105)",w.shadowColor=w.strokeStyle,w.beginPath(),w.arc(0,0,80,0,Math.PI+Math.PI),w.stroke(),w.closePath(),w.beginPath(),w.lineDashOffset=n,w.setLineDash([4,8]),w.arc(0,0,40,0,Math.PI+Math.PI),w.stroke(),w.closePath(),w.restore(),e.dashTime=s+p,e.dashTime>.1&&(e.dashTime-=.1,e.dashOffset=(n-1)%12)})(e):(e=>{const{visibleX:t,visibleY:o}=e;w.save(),w.beginPath(),w.shadowBlur=10,w.translate(Math.round(t),Math.round(o)),w.strokeStyle="rgb(55,40,35)",w.shadowColor=w.strokeStyle,w.beginPath(),w.arc(0,0,80,0,Math.PI+Math.PI),w.stroke(),w.closePath(),w.restore()})(e)}function K(e,t,o,a=f,n=1){const s=n*Y,r=e.length*s,i=a===x?r:a===M?r/2:0;[...e].forEach((e,a)=>{w.drawImage(I,u.indexOf(e)*Y,0,Y,Y,t+a*s-i,o,s,s)})}function R(){D&&(S=requestAnimationFrame(R),(()=>{switch(w.fillStyle="rgb(20,35,40)",w.fillRect(0,0,y,g),m){case n:K("subwar 2051",Y,Y),K("press any key",y/2,g/2,M),a===o.length&&K("konami mode on",y-Y,Y,x);break;case s:w.fillStyle=w.createPattern(A,"repeat"),w.fillRect(0,0,y,g),h.forEach(C),h.forEach(U),K(`sonar: ${l.online?"on":"off"}line`,Y,Y),(()=>{const e=Math.floor(Math.ceil(i)/60),t=Math.ceil(i)-60*e;K(`${e}:${t>9?"":"0"}${t}`,y-Y,Y,x)})();break;case r:K("game over",Y,Y)}v.drawImage(d,0,0,y,g,0,0,c.width,c.height)})(),k=Date.now(),p=(k-P)/1e3,(()=>{switch(m){case s:0>(i-=p)&&(m=r),F(l),E(l),h.slice(1).forEach(e=>{(e=>{let{lastDirection:t=0}=e;var o,a;t+=p,Math.random()<t/10&&(e[`move${.5>Math.random()?"X":"Y"}`]=(o=[-1,0,1])[(a=o.length-1,Math.floor(Math.random()*(a+1-0)+0))],t=0),e.lastDirection=t})(e),F(e);const t=((e,t)=>{const o={entity1MaxX:e.x+e.w,entity1MaxY:e.y+e.h,entity2MaxX:t.x+t.w,entity2MaxY:t.y+t.h};return o.collide=e.x<o.entity2MaxX&&o.entity1MaxX>t.x&&e.y<o.entity2MaxY&&o.entity1MaxY>t.y,o})(l,e);t.collide&&((e,t,o)=>{const{entity1MaxX:a,entity1MaxY:n,entity2MaxX:s,entity2MaxY:r}=o,i=a-t.x,l=n-t.y,c=s-e.x,h=r-e.y;e.moveX>0&&e.moveY>0?l>i?e.x-=i:e.y-=l:e.moveX>0&&0>e.moveY?h>i?e.x-=i:e.y+=h:e.moveX>0?e.x-=i:0>e.moveX&&e.moveY>0?l>c?e.x+=c:e.y-=l:0>e.moveX&&0>e.moveY?h>c?e.x+=c:e.y+=h:0>e.moveX?e.x+=c:e.moveY>0?e.y-=l:0>e.moveY&&(e.y+=h)})(l,e,t),((e,t)=>{t&&(e.visibleX=e.x,e.visibleY=e.y,e.visibleAngle=e.angle)})(e,l.online&&e.online),E(e)})}})(),P=k)}function O(e){(D=e)?(P=Date.now(),R()):cancelAnimationFrame(S)}onload=(async e=>{t.title="Subwar 2051",onresize(),A.width=A.height=64,b.strokeStyle="rgb(40,55,50)",b.beginPath(),b.moveTo(0,4),b.lineTo(8,4),b.stroke(),b.closePath(),b.beginPath(),b.moveTo(4,0),b.lineTo(4,8),b.stroke(),b.closePath(),I=await(e=>new Promise(t=>{var o=new Image;o.onload=(()=>{t(o)}),o.src=e}))(I),O(!0)}),onresize=e.onrotate=(()=>{d.width=y,d.height=g,c.width=1*y,c.height=1*g,v.imageSmoothingEnabled=w.imageSmoothingEnabled=!1}),t.onvisibilitychange=(e=>{O(!e.target.hidden)}),onkeydown=(e=>{if(e.preventDefault(),!e.repeat)switch(m){case s:switch(e.code){case"ArrowLeft":case"KeyA":l.moveX=-1;break;case"ArrowUp":case"KeyW":l.moveY=-1;break;case"ArrowRight":case"KeyD":l.moveX=1;break;case"ArrowDown":case"KeyS":l.moveY=1;break;case"KeyP":O(!D)}}}),onkeyup=(e=>{switch(m){case n:e.which!==o[a]||a===o.length?T():a++;break;case s:switch(e.code){case"ArrowLeft":case"KeyA":case"ArrowRight":case"KeyD":l.moveX=0;break;case"ArrowUp":case"KeyW":case"ArrowDown":case"KeyS":l.moveY=0;break;case"KeyO":case"KeyF":l.online=!l.online,l.switchModeTime=k}break;case r:switch(e.code){case"KeyT":open("https://twitter.com/intent/tweet?text=viral%20marketing%20message%20https%3A%2F%2Fgoo.gl%2Fsome tiny Google url here","_blank");break;default:m=n}}});let V=0,Z=0,z=0,W=0;function j(e){return[e.pageX||e.changedTouches[0].pageX,e.pageY||e.changedTouches[0].pageY]}e.ontouchstart=e.onpointerdown=(e=>{switch(e.preventDefault(),m){case s:[z,W]=[V,Z]=j(e)}}),e.ontouchmove=e.onpointermove=(e=>{switch(e.preventDefault(),m){case s:V&&Z&&(([e,t])=>{e>z?(z=e)-V>30&&(l.moveX=1):V>e?z-(V=e)>30&&(l.moveX=-1):z>e&&l.moveX>0?(V=e,l.moveX=0):e>V&&0>l.moveX&&(z=e,l.moveX=0),t>W?(W=t)-Z>30&&(l.moveY=1):Z>t?W-(Z=t)>30&&(l.moveY=-1):W>t&&l.moveY>0?(Z=t,l.moveY=0):t>Z&&0>l.moveY&&(W=t,l.moveY=0)})(j(e))}}),e.ontouchend=e.onpointerup=(e=>{switch(e.preventDefault(),m){case n:T();break;case s:l.moveX=l.moveY=0,V=Z=z=W=0;break;case r:m=n}})})();</script>
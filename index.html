<style>body{margin:0;text-align:center;background:#000;touch-action:none}</style><canvas id="c"></canvas><script>(()=>{const e=window,t=document,o=[38,38,40,40,37,39,37,39,66,65];let a=0;const n=0,i=1,r=2;let s,l,h,m=n;const v=c.getContext("2d"),y=320,A=240,g=c.cloneNode(),w=g.getContext("2d"),b="abcdefghijklmnopqrstuvwxyz0123456789.:!-%,/",u=0,d=1,x=2,M={player:{w:10,h:10},sub1:{w:10,h:10}},X=8;let Y,f,p,k,D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAVgAAAAIAgMAAADB+w+QAAAADFBMVEUAAAARCgP///8AAADe3w1AAAAAAXRSTlMAQObYZgAAAUlJREFUKM9VUjFuwzAMpAf5BVGB+jVeuquA6CFzUYDqZzzEQ3Z5ENr+sXeiE6MiJNFH8kTSFFXNMWtSrJhz1K7oTDgkTX2rL2L0CCkgApKp9+8kWDwvEUqU0rpUv836bWUuZjbVUvum5Vj0mIhCrEJf/Zu04yryYVBMEOBE23/afrZTHpS+mcbSbEfUrduayDCPa8zvbZiHJt1l6xSbaWkvtwgS0p4Zeij3tMOjFsQsrUC/wkvb9bcYcx3XqY4Vd2UTntlaI62xJWr3BxWwtvRaPu9ThdxAt1/3xatoQ7WvghwpsJJ8FQ/0bIuXeTxk3vOdBY/sIG5qHkFZdvoB+V6AU2Iub8NaZjlcGOIB1HH6L7M0EavIgLTQzweAMnfaflg6RcRex9lEcnwOWPIBi0lxHgMmAQDHLGjodh8o2oFm4Id4E8B3CZLlD7GmBBrI7F8nAAAAAElFTkSuQmCC",I=!0;function P(){a=0,s=60,l=F("player",y/2,A/2,30),h=[l,F("sub1",20,20),F("sub1",20,A-20),F("sub1",y-20,20),F("sub1",y-20,A-20)],m=i}function E(e){0>e.x?e.x=0:e.x>y-e.w&&(e.x=y-e.w),0>e.y?e.y=0:e.y>A-e.h&&(e.y=A-e.h)}function F(e,t=0,o=0,a=20){const{w:n,h:i}=M[e];return{h:i,lastX:t,lastY:o,moveX:0,moveY:0,online:!0,speed:a,type:e,w:n,x:t,y:o}}function S(e){const t=e.speed*f;e.x+=t*e.moveX,e.y+=t*e.moveY,e.angle=0>e.moveX&&0>e.moveY?-45:0>e.moveX&&0===e.moveY?-90:0>e.moveX&&e.moveY>0?-135:0===e.moveX&&0>e.moveY?0:e.moveX>0&&0>e.moveY?45:e.moveX>0&&0===e.moveY?90:e.moveX>0&&e.moveY>0?135:0===e.moveX&&e.moveY>0?180:0}function U(e){"player"===e.type?(e=>{const{x:t,y:o,angle:a}=e;w.save(),w.beginPath(),w.fillStyle="rgb(75,190,250)",w.translate(Math.round(t),Math.round(o)),w.rotate(a/180*Math.PI),w.arc(0,0,5,0,Math.PI+Math.PI),w.fillRect(-2,-12,4,12),w.fill(),w.closePath(),w.strokeStyle="rgb(70,105,105)",w.beginPath(),w.arc(0,0,40,0,Math.PI+Math.PI),w.stroke(),w.closePath(),w.beginPath(),w.setLineDash([2,4]),w.arc(0,0,20,0,Math.PI+Math.PI),w.stroke(),w.closePath(),w.restore()})(e):(e=>{const{visibleX:t,visibleY:o,visibleAngle:a}=e;w.save(),w.beginPath(),w.fillStyle="rgb(230,90,100)",w.translate(Math.round(t),Math.round(o)),w.rotate(a/180*Math.PI),w.fillRect(-5,-5,10,10),w.fillRect(-2,-12,4,12),w.fill(),w.closePath(),w.restore()})(e)}function K(e,t,o,a=u,n=1){const i=n*X,c=e.length*i,r=a===x?c:a===d?c/2:0;[...e].forEach((e,a)=>{w.drawImage(D,b.indexOf(e)*X,0,X,X,t+a*i-r,o,i,i)})}function B(){I&&(k=requestAnimationFrame(B),(()=>{switch(w.fillStyle="rgb(20,35,40)",w.fillRect(0,0,y,A),m){case n:K("subwar 2051",X,X),K("press any key",y/2,A/2,d),a===o.length&&K("konami mode on",y-X,X,x);break;case i:h.forEach(U),K(`sonar: ${l.online?"on":"off"}line`,X,X),(()=>{const e=Math.floor(Math.ceil(s)/60),t=Math.ceil(s)-60*e;K(`${e}:${t>9?"":"0"}${t}`,y-X,X,x)})();break;case r:K("game over",X,X)}v.drawImage(g,0,0,y,A,0,0,c.width,c.height)})(),Y=Date.now(),f=(Y-p)/1e3,(()=>{switch(m){case i:0>(s-=f)&&(m=r),S(l),E(l),h.slice(1).forEach(e=>{(e=>{let{lastDirection:t=0}=e;var o,a;t+=f,Math.random()<t/10&&(e[`move${.5>Math.random()?"X":"Y"}`]=(o=[-1,0,1])[(a=o.length-1,Math.floor(Math.random()*(a+1-0)+0))],t=0),e.lastDirection=t})(e),S(e);const t=((e,t)=>{const o={entity1MaxX:e.x+e.w,entity1MaxY:e.y+e.h,entity2MaxX:t.x+t.w,entity2MaxY:t.y+t.h};return o.collide=e.x<o.entity2MaxX&&o.entity1MaxX>t.x&&e.y<o.entity2MaxY&&o.entity1MaxY>t.y,o})(l,e);t.collide&&((e,t,o)=>{const{entity1MaxX:a,entity1MaxY:n,entity2MaxX:i,entity2MaxY:c}=o,r=a-t.x,s=n-t.y,l=i-e.x,h=c-e.y;e.moveX>0&&e.moveY>0?s>r?e.x-=r:e.y-=s:e.moveX>0&&0>e.moveY?h>r?e.x-=r:e.y+=h:e.moveX>0?e.x-=r:0>e.moveX&&e.moveY>0?s>l?e.x+=l:e.y-=s:0>e.moveX&&0>e.moveY?h>l?e.x+=l:e.y+=h:0>e.moveX?e.x+=l:e.moveY>0?e.y-=s:0>e.moveY&&(e.y+=h)})(l,e,t),((e,t)=>{t&&(e.visibleX=e.x,e.visibleY=e.y,e.visibleAngle=e.angle)})(e,l.online&&e.online),E(e)})}})(),p=Y)}function T(e){(I=e)?(p=Date.now(),B()):cancelAnimationFrame(k)}onload=(async e=>{t.title="Subwar 2051",onresize(),D=await(e=>new Promise(t=>{var o=new Image;o.onload=(()=>{t(o)}),o.src=e}))(D),T(!0)}),onresize=e.onrotate=(()=>{g.width=y,g.height=A;const e=Math.min(innerWidth/y,innerHeight/A);c.width=y*e,c.height=A*e,v.imageSmoothingEnabled=w.imageSmoothingEnabled=!1}),t.onvisibilitychange=(e=>{T(!e.target.hidden)}),onkeydown=(e=>{if(e.preventDefault(),!e.repeat)switch(m){case i:switch(e.code){case"ArrowLeft":case"KeyA":l.moveX=-1;break;case"ArrowUp":case"KeyW":l.moveY=-1;break;case"ArrowRight":case"KeyD":l.moveX=1;break;case"ArrowDown":case"KeyS":l.moveY=1;break;case"KeyP":T(!I)}}}),onkeyup=(e=>{switch(m){case n:e.which!==o[a]||a===o.length?P():a++;break;case i:switch(e.code){case"ArrowLeft":case"KeyA":case"ArrowRight":case"KeyD":l.moveX=0;break;case"ArrowUp":case"KeyW":case"ArrowDown":case"KeyS":l.moveY=0;break;case"KeyO":case"KeyF":l.online=!l.online,l.switchModeTime=Y}break;case r:switch(e.code){case"KeyT":open("https://twitter.com/intent/tweet?text=viral%20marketing%20message%20https%3A%2F%2Fgoo.gl%2Fsome tiny Google url here","_blank");break;default:m=n}}});let R=0,C=0,V=0,W=0;function Z(e){return[e.pageX||e.changedTouches[0].pageX,e.pageY||e.changedTouches[0].pageY]}e.ontouchstart=e.onpointerdown=(e=>{switch(e.preventDefault(),m){case i:[V,W]=[R,C]=Z(e)}}),e.ontouchmove=e.onpointermove=(e=>{switch(e.preventDefault(),m){case i:R&&C&&(([e,t])=>{e>V?(V=e)-R>30&&(l.moveX=1):R>e?V-(R=e)>30&&(l.moveX=-1):V>e&&l.moveX>0?(R=e,l.moveX=0):e>R&&0>l.moveX&&(V=e,l.moveX=0),t>W?(W=t)-C>30&&(l.moveY=1):C>t?W-(C=t)>30&&(l.moveY=-1):W>t&&l.moveY>0?(C=t,l.moveY=0):t>C&&0>l.moveY&&(W=t,l.moveY=0)})(Z(e))}}),e.ontouchend=e.onpointerup=(e=>{switch(e.preventDefault(),m){case n:P();break;case i:l.moveX=l.moveY=0,R=C=V=W=0;break;case r:m=n}})})();</script>